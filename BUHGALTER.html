<div class="container">
  <div class="row row-buh mb-4 mt-2 me-4">
    <div class="col col-sm-3 btn-hide">
      <div class="sticky-top nav-left radius">
        <ul class="nav flex-column buttons-buh">
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonBuh">BUHGALTER</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonNevistavleno">Не выставлено</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonNeoplacheno">Не оплачено</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonVraboteR">В работе Р</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonVraboteT">В работе т</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonSotr2">Sotr2</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonTermSum">TermSum</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonDateSost">DateSost</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonInspektor">Inspektor</button>
          </li>
          <li class="nav-item nav-buh d-grid">
            <button class="btn btn-buh d-inline-flex" id="buttonCashe">Cashe</button>
          </li>
        </ul>
      </div>
    </div>

    <div class="col-sm-9 radius arrow ms-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" color='red' fill="currentColor" visibility='hidden' class="bi bi-arrow-left" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"/>
      </svg>
      <!-- <div id="results" class="d-flex justify-content-center"></div> -->         
      <div id="results"></div>         
    </div>
  </div>  
</div> 

<!-- модальное окно для инспектора -->
<!-- Modal -->
<div class="modal fade" id="inspektorModal" tabindex="-1" aria-labelledby="inspektorModalLabel" aria-hidden="true" >
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div id="results-modal"></div>
      </div>      
    </div>
  </div>
</div> 

<script>

searchMobileNot(() => {
  $('.arrow').slideToggle();
});

//функция снятия жирного шрифта при щелчке на левое меню
const removeNavBuhActive = () => $(".btn-buh").removeClass('nav-buh-active');

// применение жирного шрифта при щелчке на левое меню
$(".btn-buh").click(function() {
  removeNavBuhActive();
  $(this).addClass('nav-buh-active');
});

//показать стрелку на мобильном 
function hideBtnBuh() {
  searchMobileNot(() => {
    $('.btn-hide').hide(350);
    $('.bi-arrow-left').attr('visibility', 'visible');
    $('.arrow').slideToggle();
  });
}   

//убрать стрелку на мобильном
$(".bi-arrow-left").click(function() {
  $('.btn-hide').show();
  $('.bi-arrow-left').attr('visibility', 'hidden');
  $('.arrow').slideToggle();
  clearDiv();
  removeNavBuhActive();
});

function clearDiv(){
 document.getElementById('results').innerHTML = ''; 
}

//BUHGALTER
function buttonClickBuh() {
  clearDiv();
  spinner('results');
  hideBtnBuh();
  google.script.run.withSuccessHandler(displayResults).buhgalterTable();
  btnTableFinance();
}

function displayResults(dataArray) {
  if(dataArray){
    let result = "<table class='table table-striped table-sm'>"
      for(let i=0; i<dataArray.length; i++) {
        result += "<tr>";
        for(var j=0; j<dataArray[i].length; j++){
          result += "<td>"+dataArray[i][j]+"</td>";
        }
        result += "</tr>";
      }
      result += "</table>";
      result = "<h3 class='d-flex justify-content-center'>Счета выставлены</h3>" + result;
      let div = document.getElementById('results');
      div.innerHTML = result;
     
  } else {
    let div = document.getElementById('results');
    div.innerHTML = "Data not found!";
  }
}

//NEVISTAVLENO - NEOPLACHENO

function startDataNevistvleno(){
  clearDiv();
  spinner('results');
  hideBtnBuh();
  google.script.run.withSuccessHandler(createTableNevistavleno).startDataNevistvleno();
}

function startDataNeoplacheno(){
  clearDiv();
  spinner('results');
  hideBtnBuh();
  google.script.run.withSuccessHandler(createTableNeoplacheno).startDataNeoplacheno();
}
function startDataVraboteR(){
  clearDiv();
  spinner('results');
  hideBtnBuh();
  google.script.run.withSuccessHandler(createTableVrboteR).startDataVraboteR();
}

function startDataVraboteT(){
  clearDiv();
  spinner('results');
  hideBtnBuh();
  google.script.run.withSuccessHandler(createTableVrboteT).startDataVraboteT();
}
  
//CREATE THE DATA TABLE
function createTableNevistavleno(dataArray) {
  const nameTable = dataArray.slice();
  dataArray.splice(0, 2);
  dataArray = dataArray.map(x => [x[4], x[2], x[3]]);
  if(dataArray){
    let result = `<div class='radius p-2'><table class='table table-sm table-line-selection table-btn-edit table-responsive' >`+
                 `<thead style='white-space: nowrap'><tr>`;
    result += `<th>Проект</th>`;
    result += `<th>Фирма</th>`;
    result += `<th>Работа</th>`;
    result += `<th>В реестр</th>`;
    result += `<th>В финансы</th>`;
    result += "</tr>"+"</thead>";
    for(let i=1; i<dataArray.length; i++) {
      result += `<tr valign="middle">`;
      for(var j=0; j<dataArray[i].length; j++){
        result += "<td>"+dataArray[i][j]+"</td>";
      }
      result += `<td align="center"><button type="button" id="buttonNevistavlenoReestr${i}" something-row= "${i}" something-col= "1" class="btn btn-light btn-nevistavleno-reestr btn-edit"/>Edit</button></td>`;
      result += `<td align="center"><button type="button" id="buttonNevistavlenoFinance${j}" something-row= "${i}" something-col= "2" class="btn btn-light btn-nevistavleno-finance btn-edit"/>Edit</button></td>`;
      result += "</tr>";
    }
    result += "</table></div>";
    result = "<h5 class='d-flex justify-content-center'>Не выставлено</h5>" + result;
    let div = document.getElementById('results');
    div.innerHTML = result;
  } else {
    let div = document.getElementById('results');
    div.innerHTML = "Data not found!";
  }
  tableLineSelection(); //полосы в таблице
  btnEdit(dataArray);
}

function createTableNeoplacheno(dataArray) {
  const nameTable = dataArray.slice()
  dataArray.splice(0, 2)
  dataArray = dataArray.map(x => [x[0],x[1],x[2],x[3]])
  if(dataArray){
    let result = `<div class='radius p-2'><table class='table table-sm table-line-selection table-btn-edit table-responsive' >`+
                 `<thead style='white-space: nowrap'><tr>`;
    result += `<th>Проект</th>`;
    result += `<th>Сумма</th>`;
    result += `<th>Фирма</th>`;
    result += `<th>Дата конца</th>`;
    result += `<th>В реестр</th>`;
    result += `<th>В финансы</th>`;
    result += "</tr>"+"</thead>";
    for(let i=1; i<dataArray.length; i++) {
      result += `<tr valign="middle">`;
      for(var j=0; j<dataArray[i].length; j++){
        result += "<td>"+dataArray[i][j]+"</td>";
      }
      if(i < dataArray.length-3){
        result += `<td align="center"><button type="button" id="buttonNeoplachenoReestr${i}" something-row= "${i}" something-col= "1" class="btn btn-light btn-Neoplacheno-reestr btn-edit"/>Edit</button></td>`;
        result += `<td align="center"><button type="button" id="buttonNeoplachenoFinance${j}" something-row= "${i}" something-col= "2" class="btn btn-light btn-Neoplacheno-finance btn-edit"/>Edit</button></td>`;
      }
      result += "</tr>";          
    }      
    result += "</table></div>";
    result = "<h5 class='d-flex justify-content-center'>Не опллачено</h5>" + result;
    let div = document.getElementById('results');
    div.innerHTML = result;
  } else {
    let div = document.getElementById('results');
    div.innerHTML = "Data not found!";
  }
  tableLineSelection(); //полосы в таблице
  btnEdit(dataArray);
}

function createTableVrboteR(dataArray) {
  const nameTable = dataArray.slice()
  dataArray.splice(0, 2)
  dataArray = dataArray.map(x => [x[1],x[2],x[3],x[4]])
  if(dataArray){
    let result = "<div class='radius p-2'><table class='table table-striped table-sm table-line-selection ' >"+
                 "<thead style='white-space: nowrap'><tr>";
    for(let i=0; i<dataArray[i].length; i++){
      result += "<th>"+dataArray[0][i]+"</th>";
    }               
    result += "</tr>"+"</thead>";
    for(let i=1; i<dataArray.length; i++) {
      result += "<tr>";
      for(let j=0; j<dataArray[i].length; j++){
        result += "<td>"+dataArray[i][j]+"</td>";
      }
      result += "</tr>";
    }
    result += "</table></div>";
    result = "<h5 class='d-flex justify-content-center'>В работе разрешиловка</h5>" + result;
    let div = document.getElementById('results');
    div.innerHTML = result;
  } else {
    var div = document.getElementById('results');
    div.innerHTML = "Data not found!";
  }
  tableLineSelection(); //полосы в таблице
}
  
function createTableVrboteT(dataArray) {
  const nameTable = dataArray.slice()
  dataArray.splice(0, 2)
  dataArray = dataArray.map(x => [x[1],x[2],x[3],x[4]])
  if(dataArray){
    let result = "<div class='radius p-2'><table class='table table-striped table-sm table-line-selection '>"+
                  "<thead style='white-space: nowrap'><tr>";
    for(let i=0; i<dataArray[i].length; i++){
      result += "<th>"+dataArray[0][i]+"</th>";
    }               
    result += "</tr>"+"</thead>";
    for(let i=1; i<dataArray.length; i++) {
      result += "<tr>";
      for(let j=0; j<dataArray[i].length; j++){
        result += "<td>"+dataArray[i][j]+"</td>";
      }
      result += "</tr>";
    }
    result += "</table></div>";
    result = "<h5 class='d-flex justify-content-center'>В работе таможня</h5>" + result;
    let div = document.getElementById('results');
      div.innerHTML = result;
  } else {
    let div = document.getElementById('results');
    div.innerHTML = "Data not found!";
  }
  tableLineSelection(); //полосы в таблице
}
  
//TermSum
function buttonClickTermSum(){
  clearDiv();
  spinner('results');
  hideBtnBuh();
  google.script.run.withSuccessHandler(function displayResultsTermSum(dataTermSum){
    let result = "<div class='col-xl-5 radius p-2'><table class='table table-sm' >";
    result += "<tr>";
    result += "<td><b>Терминал Новопироговская:</b></td>";
    result += "</tr>";
    result += "<tr>";
    result += "<td>"+dataTermSum[0]+"</td>";
    result += "</tr>";
    result += "<tr>";
    result += "<td>"+"остаток " + dataTermSum[1] + " грн."+"</td>";
    result += "</tr>";
    result += "</table></div>";
    document.getElementById('results').innerHTML = result;
    /* document.getElementById('vrabotevse1').innerHTML = dataTermSum[0]
    document.getElementById('vrabotevse2').innerHTML = 'остаток денег: '
    document.getElementById('vrabotevse3').innerHTML = dataTermSum[1] + 'грн.' */
  }).dataTermSum();
}


//DATESOSOT
function buttonClickDateSost(){
  clearDiv();
  spinner('results');
  bildHtmlDateSost();
  hideBtnBuh();
}

//функция формирования формы заполения и кнопок
function bildHtmlDateSost() {
    google.script.run.withSuccessHandler(dataDateSost => {
      let result = `<div"><b>Дата состояния: ${dataDateSost}</b></div>`;
      result += displayResultsDateSost();
      document.getElementById("results").innerHTML = result;
    }).dataDateSost();
}

function displayResultsDateSost(){
 // const elementValue = document.getElementById("results").innerHTML;
  let result = "<div class=\"col-md-4 radius p-2\" onkeypress=\"clickPressDatesost(event)\">";
  result += "<input type=\"date\" id=\"up_datesost\" value=\"\" class=\"form-control\" /> ";
  result += "</div> ";
  result += "<input type=\"button\" id=\"update_button_datesost\" value=\"Update\" class=\"btn btn-danger mb-2\"  ";
  result += "onclick=\"updateDateSost()\" /></div> ";
  result += "<input type=\"button\" id=\"clear_button_datesost\" value=\"Clear\" class=\"btn btn-danger mb-2\"  ";
  result += "onclick=\"clearDateSost()\" /></div> ";
  result += "<input type=\"button\" id=\"yesterday_button_datesost\" value=\"Yesterday\" class=\"btn btn-danger mb-2\"  ";
  result += "onclick=\"yesterdayDateSost()\" /></div> ";
  result += "<input type=\"button\" id=\"today_button_datesost\" value=\"Today\" class=\"btn btn-danger mb-2\"  ";
  result += "onclick=\"todayDateSost()\" /></div> ";
  return result;
  //result += elementValue;
  //elementValue = result;
}

function clearDateSost(){
  document.getElementById("clear_button_datesost").disabled = true;
  document.getElementById("up_datesost").value = '';
  document.getElementById("clear_button_datesost").disabled = false;
}

function updateDateSost(){
  document.getElementById("update_button_datesost").disabled = true;
  const dateSost = document.getElementById("up_datesost").value;
  if(dateSost){
    google.script.run.withSuccessHandler(function(return_string){
  }).updateDateSostGs(dateSost);
  document.getElementById("results").innerHTML = "Дата состояния:"+" <b>"+ new Date(dateSost).toLocaleDateString() + "</b>" + displayResultsDateSost();
  };
  document.getElementById("update_button_datesost").disabled = false;
  clearDateSost();
}

function todayDateSost() {
  google.script.run.withSuccessHandler(function(return_string){
  }).updateDateSostGs(new Date().toLocaleDateString());
  document.getElementById("results").innerHTML = "Дата состояния:"+" <b>"+ new Date().toLocaleDateString() + "</b>" + displayResultsDateSost();
}

function yesterdayDateSost() {
  google.script.run.withSuccessHandler(function(return_string){
  }).updateDateSostGs(new Date(Date.now()-86400000).toLocaleDateString());
  document.getElementById("results").innerHTML = "Дата состояния:"+" <b>"+ new Date(Date.now()-86400000).toLocaleDateString() + "</b>" + displayResultsDateSost(); 
}
////END DATESOSOT

////INSPEKTOR
function buttonClickInspektor(){
  clearDiv();
  spinner('results');
  hideBtnBuh();
  google.script.run.withSuccessHandler(function displayResultsInspektor(dataArray){
  if(dataArray){
    var result = "<div class='col-xl-6 radius p-2'><table id='tableInspektor' data-bs-toggle=\"modal\" data-bs-target=\"#inspektorModal\" class='table table-sm'>";
    result+= "<tr><th>Исполнитель</th><th>Сумма, грн</th><td>"
    for(let i=0; i<dataArray.length; i++) {
      result += "<tr>";
      for(let j=0; j<dataArray[i].length; j++) {
        result += "<td>"+dataArray[i][j]+"</td>";                  
      }
      result += "</tr>";
    }
    result += "</table></div>";
    var div2 = document.getElementById('results');
    div2.innerHTML = result;
    } else {
      var div = document.getElementById('results');
      div.innerHTML = "Data not found!";
    }
    btnInsp();
  }).inspektorGs();
}

function debtsToInspectors(dataArray) {
  let result = "<table id='tableInspektorModal'  class='table table-sm'>";
  result += "<tr><th>Проект</th><th>Фирма</th><th>Исполнитель</th><th>Сумма</th><td>"
  for(let i=0; i<dataArray.length; i++) {
    result += "<tr>";
    for(let j=0; j<dataArray[i].length; j++) {
      result += "<td>"+dataArray[i][j]+"</td>";                  
    }result += "</tr>";                
  }
  result += "</table>";
  document.getElementById('results-modal').innerHTML = result;
  btnInspModal();
}

// клик по таблице инспектора и открытие модалки
function btnInsp() {
  $('#tableInspektor tr td').bind('click', function() {
    spinner('results-modal');
    const insp = valueCellCol(this, 0);
    google.script.run.withSuccessHandler(debtsToInspectors).debtsToInspectorsGs(insp);
  })
}

// клик по таблице модалки, запоминание номера проекта и переход на финансы
function btnInspModal() {
  $('#tableInspektorModal tr td').bind('click', function() {
    const proekt = valueCellCol(this, 0);
    localStorage.removeItem('proekt')
    sessionStorage.setItem('proekt', proekt);
    const dataTarget = event.target.textContent;
    console.log(dataTarget);
    $('.btn-close').click();
    $('#btnSearchFinMinus').click();
    $('#btnClearSearchFinance').click();
    $('#proektreestr').val(proekt);  
    $('#data-table_filter input').val(dataTarget); 
    $('#btnSearchReestrInfo').html(proekt);
    $('#btnSearchFinInfo').html('fin ' + proekt);
    $('#btnSearchFinPlus').html('fin+');
    $('#btnSearchFinMinus').html('fin-');
    $('#btnSearchJobInfo').html('job ' + proekt);
    $('#nav-reestr-tab')[0].click();
    $('#btnClearSearchReestr').click();
    autoSearchOnOpen('.dataTables_filter input');
    /* $('.btn-close').click();
    $('#btnClearSearchFinance').click();
    $('#nav-fin-tab')[0].click();
    $('#proektfin').val(proekt);  
    $('#searchFinance').val(proekt);
    autoSearchOnOpen('#searchFinance'); */
  })
}

////END INSPEKTOR

  //обработка кнопок
  $('.buttons-buh li button').bind('click', function () {
    sessionStorage.setItem('buttonsBuhLiButton', '#' + this.id);
    switch ('#' + this.id) {
      case '#buttonBuh':
        buttonClickBuh();
        break;
      case '#buttonNevistavleno':
        startDataNevistvleno();
        break;
      case '#buttonNeoplacheno':
        startDataNeoplacheno();
        break;
      case '#buttonVraboteR':
        startDataVraboteR();
        break;
      case '#buttonVraboteT':
        startDataVraboteT();
        break;
      case '#buttonTermSum':
        buttonClickTermSum();
        break;
      case '#buttonSotr2':
        startDataSotr2();
        break;
      case '#buttonDateSost':
        buttonClickDateSost();
        break;
      case '#buttonInspektor':
        buttonClickInspektor();
        break;
      case '#buttonCashe':
        buttonClickCashe();
        break;
    }
  });


//Sotr2
function startDataSotr2(){
  clearDiv();
  spinner('results');
  hideBtnBuh();
  startDataSotrCount2();
}

function startDataSotrCount2(){
  google.script.run.withSuccessHandler(createTableSotrCount2).testSotrCount();
}
 
function createTableSotrCount2(dataArray) {
  const dataArrayRes1 = dataArray.res1; // фамилия сотрудника + количество работ
  const dataArrayRes2 = dataArray.res2; // вся таблица Sotr
  const dataArrayRes3 = dataArray.res3; // только фамилии
  const dataChel = dataArray.res2.map(x=> [x[0]]);
  const dataChelLength = dataArray.res2.map(x=> [x[1]]);
  const dataArrayRes1Len = dataArrayRes1.length
  let result;
  if(dataArrayRes1){
    result = "<div class='radius p-2'><table class='table table-sm tablesotr2' >"
    for(let i=0; i<dataArrayRes1.length; i++) {
      result += `<tr valign="middle">`;
      result += "<td>"+dataArrayRes1[i]+"</td>";
      result += "</tr>";
    }
    result += "</table></div>";
    result = "<h5 class='d-flex justify-content-center'>Sotr2</h5>" + result;
  } else {
    const div = document.getElementById('results');
    div.innerHTML = "Data not found!";
  }
  if(dataArrayRes2){
    for(let ii=0; ii< dataArrayRes3.length; ii++){
      let dataArrayResFilter = dataArrayRes2.filter(x => x[0] === dataArrayRes3[ii])
      dataArrayResFilter = dataArrayResFilter.map(x => [x[4], x[2], x[3]])
      result += `<div class='radius p-2 my-3'><table id="tablesotr2${ii}" class="table table-sm tablesotr2" >`
      result += "<tr valign=\"middle\"><th valign=\"middle\" colspan=\"4\">"+dataArrayRes1[ii]+"</th><th></th><th></th><th></th><th></th></tr>"; 
      for(let i=0; i<dataArrayResFilter.length; i++) {
        result += `<tr valign="middle">`;
        for(let j=0; j<dataArrayResFilter[i].length; j++) {
          result += "<td class='tablesotr2col"+j+"'>"+dataArrayResFilter[i][j]+"</td>";
        }
        result += `<td width="20%" align="center"><button type="button" something-col= "1" class="btn btn-light btn-edit-sotr2 btn-reestr-transition">В&nbsp;реестр</button></td>`;
        result += `<td width="20%" align="center"><button type="button" something-col= "2" class="btn btn-light btn-edit-sotr2">В&nbsp;финансы</button></td>`;
        result += "</tr>";
      }
      result += "</table></div>";
    }
    const div2 = document.getElementById('results');
    div2.innerHTML = result;
  } else {
    const div = document.getElementById('results');
    div.innerHTML = "Data not found!";
  }
  btnEditSotr2();   
}
  
// обработка кнопок Edit на sotr2
function btnEditSotr2() {
  $('.btn-edit-sotr2').click (function(){
    const data = Array.from(this.parentNode.parentNode.children);
    const text = getDataFromTd(data);
    const col = this.getAttribute('something-col');
    editReestrFinance(text[0], col);
    autoSearchOnOpen('.dataTables_filter input');
    autoSearchOnOpen('#searchFinance');

  });
}

//обработка кнопок Edit на не выставлено и не оплачено
function btnEdit(data) {
  $('.btn-edit').click (function(){
    const row = this.getAttribute('something-row');
    const col = this.getAttribute('something-col');
    const tdata = data[row][0];
    editReestrFinance(tdata, col);
    autoSearchOnOpen('.dataTables_filter input');
    autoSearchOnOpen('#searchFinance');
  });
}
////// конец sotr2//////////////

// cрабатывание по кнопке Enter Datesost
function clickPressDatesost(event) {
  if (event.keyCode == 13) {
    updateDateSost();
  };
}


/* архивный SOTR*/
/* 
$('#buttonSotr').bind('click', startDataSotr);
  function startDataSotr(){
    clearDiv()
    spinner('results')
    hideBtnBuh()
    //buttonClickBuh()
    startDataSotrCount()
    startDataSotrDataLazorenko()
   // startDataSotrDataDilanjan()
    startDataSotrDataKinzerskiy()
    startDataSotrDataZinonkina()
  }

  function startDataSotrCount(){
    google.script.run.withSuccessHandler(createTableSotrCount).startDataSotrGs();
  }
 
  function startDataSotrDataLazorenko(){
    google.script.run.withSuccessHandler(function createTableSotrLazorenko(arr){
        const dataArraySotr = arr.resLazorenko
        const nameSotr = arr.nameLazorenko
        const countSotr = arr.countLazorenko
        createTableSotData(dataArraySotr,nameSotr,1,countSotr)})
        .startDataSotrGs();
  }

  function startDataSotrDataDilanjan(){
    google.script.run.withSuccessHandler(function createTableSotrDilanjan(arr){
        const dataArraySotr = arr.resDilanjan
        const nameSotr = arr.nameDilanjan
        const countSotr = arr.countDilanjan
        createTableSotData(dataArraySotr,nameSotr,2,countSotr)})
        .startDataSotrGs();
  }

  function startDataSotrDataKinzerskiy(){
    google.script.run.withSuccessHandler(function createTableSotrKinzerskiy(arr){
        const dataArraySotr = arr.resKinzerskiy
        const nameSotr = arr.nameKinzerskiy
        const countSotr = arr.countKinzerskiy
        createTableSotData(dataArraySotr,nameSotr,3,countSotr)})
        .startDataSotrGs();
  }
  
  function startDataSotrDataZinonkina(){
    google.script.run.withSuccessHandler(function createTableSotrZinonkina(arr){
        const dataArraySotr = arr.resZinonkina
        const nameSotr = arr.nameZinonkina
        const countSotr = arr.countZinonkina
        createTableSotData(dataArraySotr,nameSotr,4,countSotr)})
        .startDataSotrGs();
  }

  function createTableSotrCount(dataArray) {
  const dataArrayCount = [
                          [dataArray.nameLazorenko, dataArray.countLazorenko],
                         // [dataArray.nameDilanjan, dataArray.countDilanjan],
                          [dataArray.nameKinzerskiy, dataArray.countKinzerskiy],
                          [dataArray.nameZinonkina, dataArray.countZinonkina],
                          ]
  
      if(dataArrayCount){
      var result = "<table class='table table-striped table-sm' style='font-size:0.9em'>"
      
      for(var i=0; i<dataArrayCount.length; i++) {
          result += "<tr>";
          
          for(var j=0; j<dataArrayCount[i].length; j++){
              result += "<td>"+dataArrayCount[i][j]+"</td>";
          }
          result += "</tr>";
      }
      result += "</table>";
      result = "<h5 class='d-flex justify-content-center'>Sotr</h5>" + result;
      var div = document.getElementById('results');
      div.innerHTML = result;
           
     } else {
      var div = document.getElementById('results');
      div.innerHTML = "Data not found!";      
    } 
} 

 
  
  function createTableSotData(dataArraySotr,nameSotr,item,countSotr) {
   
   dataArraySotr.slice()
   dataArraySotr.splice(0, 2)
   dataArraySotr = dataArraySotr.map(x => [x[1],x[2],x[3],x[4]])
   
      if(dataArraySotr){
      let result = "<table class='table table-striped table-sm' style='font-size:0.9em'>"+
                   "<thead style='white-space: nowrap'><tr>"
        for(let i=0; i<dataArraySotr[0].length; i++){
              result += "<th>"+dataArraySotr[0][i]+"</th>";
          }               
      result += "</tr>"+"</thead>";
      for(let i=1; i<dataArraySotr.length; i++) {
          result += `<tr valign="middle">`;
          
          for(let j=0; j<dataArraySotr[i].length; j++){
              result += "<td>"+dataArraySotr[i][j]+"</td>";
          }
          result += "</tr>";
      }
      result += "</table>";
      let div = document.getElementById('results'+item);
      div.innerHTML = result;
      document.getElementById('results'+item).innerHTML = nameSotr +' - '+ countSotr
     } else {
      var div = document.getElementById('results'+item);
      div.innerHTML = "Data not found!";
    }
 
*/
/* конец архивного SOTR */

</script>