<script>
    //DATESOSOT
    function buttonClickDateSost() {
        clearDiv();
        spinner('results');
        bildHtmlDateSost();
        hideBtnBuh();
    }

    // cрабатывание по кнопке Enter Datesost
    function clickPressDatesost(event) {
        if (event.keyCode == 13) {
            updateDateSost();
        }
    }

    //функция формирования формы заполения и кнопок
    function bildHtmlDateSost() {
        google.script.run.withSuccessHandler(dataDateSost => {
            let result = `<div"><b>Дата состояния: ${dataDateSost}</b></div>`;
            result += displayResultsDateSost();
            document.getElementById("results").innerHTML = result;
        }).dataDateSost();
    }

    function displayResultsDateSost() {
        // const elementValue = document.getElementById("results").innerHTML;
        let result = "<div class=\"col-md-4 radius p-2\" onkeypress=\"clickPressDatesost(event)\">";
        result += "<input type=\"date\" id=\"up_datesost\" value=\"\" class=\"form-control\" /> ";
        result += "</div> ";
        result += "<input type=\"button\" id=\"update_button_datesost\" value=\"Update\" class=\"btn btn-danger mb-2\"  ";
        result += "onclick=\"updateDateSost()\" /></div> ";
        result += "<input type=\"button\" id=\"clear_button_datesost\" value=\"Clear\" class=\"btn btn-danger mb-2\"  ";
        result += "onclick=\"clearDateSost()\" /></div> ";
        result += "<input type=\"button\" id=\"yesterday_button_datesost\" value=\"Yesterday\" class=\"btn btn-danger mb-2\"  ";
        result += "onclick=\"yesterdayDateSost()\" /></div> ";
        result += "<input type=\"button\" id=\"today_button_datesost\" value=\"Today\" class=\"btn btn-danger mb-2\"  ";
        result += "onclick=\"todayDateSost()\" /></div> ";
        return result;
        //result += elementValue;
        //elementValue = result;
    }

    function clearDateSost() {
        document.getElementById("clear_button_datesost").disabled = true;
        document.getElementById("up_datesost").value = '';
        document.getElementById("clear_button_datesost").disabled = false;
    }

    function updateDateSost() {
        document.getElementById("update_button_datesost").disabled = true;
        const dateSost = document.getElementById("up_datesost").value;
        if (dateSost) {
            google.script.run.withSuccessHandler(function (return_string) {
            }).updateDateSostGs(dateSost);
            document.getElementById("results").innerHTML = "Дата состояния:" + " <b>" + new Date(dateSost).toLocaleDateString() + "</b>" + displayResultsDateSost();
        };
        document.getElementById("update_button_datesost").disabled = false;
        clearDateSost();
    }

    function todayDateSost() {
        google.script.run.withSuccessHandler(function (return_string) {
        }).updateDateSostGs(new Date().toLocaleDateString());
        document.getElementById("results").innerHTML = "Дата состояния:" + " <b>" + new Date().toLocaleDateString() + "</b>" + displayResultsDateSost();
    }

    function yesterdayDateSost() {
        google.script.run.withSuccessHandler(function (return_string) {
        }).updateDateSostGs(new Date(Date.now() - 86400000).toLocaleDateString());
        document.getElementById("results").innerHTML = "Дата состояния:" + " <b>" + new Date(Date.now() - 86400000).toLocaleDateString() + "</b>" + displayResultsDateSost();
    }    
</script>