<script>

const btnCasheromInsert = document.querySelector('.btn-casherom__insert');

if (btnCasheromInsert) {
  btnCasheromInsert.addEventListener('click', () => {
    btnCasheromInsert.disabled = true;
    const casheRom2 = JSON.parse(localStorage.getItem('casheRom2'));
    let emptyBelow = 0;
    for (let i = casheRom2.length - 1; i > 0; i--) {
      if (!casheRom2[i][1]) emptyBelow++;
      else break;
    }
    console.log(casheRom2.length);
    console.log(emptyBelow);
    
    google.script.run.withSuccessHandler(() => {
      btnCasheromInsert.disabled = false;
      startDataTableCasherom();
    }).insertRowCasheRom((casheRom2.length - 2) - emptyBelow);
  });
}

function startova() {
  google.script.run
    .withSuccessHandler((dataArray) => {
      const arrWaste = dataArray[0].data.map(x => [x[3], x[2]]);
      const arrArrival = dataArray[1].data.map(x => [x[4], x[2]]);
      const arr = [...arrWaste, ...arrArrival];
      const elemWaste = document.querySelector('#waste');
      if (elemWaste) {
        elemWaste.oninput = () => {
          arr.forEach(el => {
            if (elemWaste.value == el[0]) {
              document.querySelector('#forma').value = el[1];
            }
          });
        };
      }
    }).getLastTenRowsWasteAndArriwal();
}
startova();

</script>