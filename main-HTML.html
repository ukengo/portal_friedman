<!doctype html>
<html lang="ua">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">

  <!-- Bootstrap CSS -->
  <?!= include("bootstrap-css") ?>
  <?!= include("bootstrap-script") ?>

  <!-- CSS -->
  <?!= include("css/css") ?>
  <?!= include("css/reset-css") ?>
  <?!= include("css/workers-css") ?>

</head>

<body>

  <header id="header">
    <nav class="navbar navbar-expand-lg navbar-dark bg-gradient-danger bg-danger sticky-top user-select-none"
      role="navigation">
      <div class="container-fluid">
        <a href="#" class="navbar-brand" id="nav-brand-tab">FRIEDMAN</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navContent"
          aria-controls="navContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navContent">
          <ul class="nav navbar-nav mr-auto mb-3 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" href="#" id="nav-newproekt-tab" data-bs-toggle="tab" data-bs-target="#nav-newproekt"
                type="button" role="tab" aria-controls="nav-newproekt" aria-selected="true">Внесення нового проєкту</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="nav-arriwalwaste-tab" data-bs-toggle="tab" data-bs-target="#nav-arriwalwaste"
                type="button" role="tab" aria-controls="nav-arriwalwaste" aria-selected="true">Прихід-витрати</a>
            </li>
            <li class="nav-item active">
              <a class="nav-link active" id="nav-buhgalter-tab" data-bs-toggle="tab" data-bs-target="#nav-buhgalter"
                type="button" role="tab" aria-controls="nav-buhgalter" aria-selected="true">BUHGALTER</a>
            </li>

            <li class="nav-item">
              <a class="nav-link" id="nav-fin-tab" data-bs-toggle="tab" data-bs-target="#nav-fin" type="button"
                role="tab" aria-controls="nav-fin" aria-selected="true">Фінанси</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="nav-reestr-tab" data-bs-toggle="tab" data-bs-target="#nav-reestr" type="button"
                role="tab" aria-controls="nav-reestr" aria-selected="true">Реєстр</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="nav-job-tab" data-bs-toggle="tab" data-bs-target="#nav-job" type="button"
                role="tab" aria-controls="nav-job" aria-selected="true">job</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="nav-casherom-tab" data-bs-toggle="tab" data-bs-target="#nav-casherom"
                type="button" role="tab" aria-controls="nav-casherom" aria-selected="true">CasheRom</a>
            </li>
          </ul>
          <div class="nav-link mx-2" id="updateAll">
            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" color='white' fill="currentColor"
              class="bi bi-arrow-repeat" viewBox="0 0 16 16">
              <path
                d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z" />
              <path fill-rule="evenodd"
                d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z" />
            </svg>
          </div>
          <div class="nav-link mx-2" id="delStorageAll">
            <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" color='white' fill="currentColor"
              class="bi bi-x-circle" viewBox="0 0 16 16">
              <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
              <path
                d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z" />
            </svg>
          </div>
          <div class="text-light position-absolute end-0 translate-middle-y top-50">
            <div><input type="date" class="bg-danger form-control" id="calendar"></div>
          </div>
          <div id='nav_finance_data' class="text-light position-absolute end-0 p-5 translate-middle-y top-50">
            <div class="nav-maim-data-date d-flex justify-content-center"></div>
            <div class="nav-maim-data-time d-flex justify-content-center"></div>
          </div>
        </div>
    </nav>
    <header>
      <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade" id="nav-newproekt" role="tabpanel" aria-labelledby="nav-newproekt-tab">
          <?!= loadNewProektView() ?>
        </div>
        <div class="tab-pane fade" id="nav-arriwalwaste" role="tabpanel" aria-labelledby="nav-arriwalwaste-tab">
          <?!= loadArriwalWasteView() ?>
        </div>
        <div class="tab-pane active" id="nav-buhgalter" role="tabpanel" aria-labelledby="nav-buhgalter-tab">
          <?!= loadBuhgalterView() ?>
        </div>

        <div class="tab-pane fade" id="nav-fin" role="tabpanel" aria-labelledby="nav-fin-tab">
          <?!= loadTableFinanceView() ?>
        </div>
        <div class="tab-pane fade" id="nav-reestr" role="tabpanel" aria-labelledby="nav-reestr-tab">
          <?!= loadTableReestrView() ?>
        </div>
        <div class="tab-pane fade" id="nav-job" role="tabpanel" aria-labelledby="nav-job-tab">
          <?!= loadTableJobView() ?>
        </div>
        <div class="tab-pane fade" id="nav-casherom" role="tabpanel" aria-labelledby="nav-casherom-tab">
          <?!= loadTableCasheRom() ?>
        </div>
      </div>

      <div id="app"></div>

      <!-- Підключаємо скрипти
      ============================================================================= -->


      <?!= include("snippets")?>

      <!-- classes ---------------------------------------------->
      <?!=include("src/classes/FormDataFromTables/FormDataFromTables-script")?>
      <?!= include("src/classes/FormDataFromTables/FormDataFromTablesWithoutRed-script")?>
      <?!= include("src/classes/FinanceFormBuilder/FinanceFormBuilder-script")?>
      <?!= include("src/classes/FinanceFormBuilder/FinanceFormBuilder-css")?>
      <?!= include("src/classes/CreateTable/CreateTable-script")?>
      <?!= include("src/classes/CreateTable/CreateTable-css")?>
      <?!= include("src/classes/Button/Button.html")?>
      <?!= include("src/classes/Button/Button-script")?>
      <?!= include("src/classes/Button/Button-css.html")?>


      <!-- Dialog -->
      <?!= include("src/classes/Dialog/Dialog")?>
      <?!= include("src/classes/Dialog/Dialog-css")?>
      <?!= include("src/classes/Dialog/Dialog-script")?>
      <!-- classes --END-------------------------------------------->

      <?!= include("src/classes/FormDataFromTables/FormDataFromTables-script")?>
      <?!= include("src/classes/FormDataFromTables/FormDataFromTablesWithoutRed-script")?>

      <?!= include("src/classes/FinanceFormBuilder/FinanceFormBuilder-script")?>
      <?!= include("src/classes/FinanceFormBuilder/FinanceFormBuilder-css")?>
      <?!= include("src/classes/CreateTable/CreateTable-script")?>
      <?!= include("src/classes/CreateTable/CreateTable-css")?>
      <?!= include("src/classes/Button/Button.html")?>
      <?!= include("src/classes/Button/Button-script")?>
      <?!= include("src/classes/Button/Button-css.html")?>

      <!-- Dialog -->
      <?!= include("src/classes/Dialog/Dialog")?>
      <?!= include("src/classes/Dialog/Dialog-css")?>
      <?!= include("src/classes/Dialog/Dialog-script")?>
      <!-- classes --END-------------------------------------------->

      <?!= include("main-downloads")?>
      <?!= include("arriwalwaste/arrivalWaste-script")?>
      <?!= include("newproekt/newProekt-script")?>
      <?!= include("finance/finance-script")?>
      <?!= include("finance/finance-local-script")?>
      <?!= include("reestr/tableReestr-local-script")?>
      <?!= include("reestr/tableReestr-script")?>
      <?!= include("reestr/tr-modal-script")?>
      <?!= include("job/job-script")?>
      <?!= include("arriwalwaste/workers/workers-script")?>


      <!-- modules/datatables -->
      <?!= include("modules/datatables/datatables-script.html")?>
      <!-- modules/popups -->
      <?!= include("modules/popups/popup-script")?>

      <!-- cashe-rom -->
      <?!= include("cashe-rom/cashe-rom-script")?>
      <?!= include("cashe-rom/cashe-rom-datatable-script.html")?>
      <?!= include("cashe-rom/cashe-rom-forma.html")?>



      <script>
        "use strict";
        window.onload = function () {
          lastPageOnReload();
          ifLastBuc();
          startTableNewProekt();
          startTableReestr();
          startTableFinance();
          startArrivalWaste();
        }



        // функция, которая при перезагрузке открывает последнюю просмотренную страницу
        function lastPageOnReload() {
          const elem = $('.nav-link').click(function () {
            localStorage.setItem('idElemNavLink', this.id);
          });
          const getItemStorage = localStorage.getItem('idElemNavLink');
          if (getItemStorage) {
            $(`#${getItemStorage}`)[0].click();
          } else {
            $('#nav-buhgalter-tab')[0].click();
          }
        }

        // функция, которая проверяет, если последняя сраница была Бухгалтер, запускает последнюю нажатую кнопку
        function ifLastBuc() {
          //if(localStorage.getItem('idElemNavLink') === 'nav-buhgalter-tab') {
          $(localStorage.getItem('buttonsBuhLiButton')).click();
          // все кнопки с бухгалтера enabled
          document.querySelectorAll(".btn-buh").forEach(btn => btn.disabled = false);
          // } 
        }

        // имитация клика на Бренд
        document.getElementById("nav-brand-tab").addEventListener("click", () =>
          document.getElementById("nav-buhgalter-tab").click());

        // вставка дати на головну
        (function addDate() {
          document.querySelector('.nav-maim-data-date').innerText = formatDateTime(new Date(), `dd.mm.yyyy`);
          document.querySelector('.nav-maim-data-time').innerText = formatDateTime(new Date(), `hh:mm`);
          setTimeout(addDate, 30000);
        })();

        // Імітація кліка на календар
        /*        document.getElementById("nav_finance_data").addEventListener("click", () =>
                  document.getElementById("calendar").click());
         */

      </script>

</body>

</html>