<script>

  document.querySelector('#delStorageAll').addEventListener('mouseup', () => {
    localStorage.clear();
    alert('storage очищено');
  });

  document.querySelector('#updateAll').addEventListener('mouseup', function () {
    btnTable()
    btnTableFinance()
    onlineDownloads()
    startDataTableCasherom()
  });

  refreshCacheLong();
  function refreshCacheLong() {
    const minLongStart = 60;
    onlineDownloads();
    const refreshLong = setTimeout(refreshCacheLong, minLongStart * 1000 * 60);
  }

  /*   document.addEventListener('click', (event) => {
      if (event.target.tagName === 'INPUT') {
        const minShortStart = 10;
        const minShortStop = 15;
        const refreshShort = setTimeout(() => {
          onlineDownloads(); console.log('refreshShort');
        }, minShortStart * 1000 * 60);
        const refreshShortStop = setTimeout(() => {
          clearInterval(refreshShort)
          console.log('refreshShortStop');
        }, minShortStop * 1000 * 60);
      }
    }); */

  // завантаженя в локал
  function onlineDownloads() {

    document.querySelector('.bi-arrow-repeat').style.color = '#ef7f7f';

    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataReestr', JSON.stringify(data));
      document.querySelector('.bi-arrow-repeat').style.color = 'white';
    }).getRecordsReestr();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataFin', JSON.stringify(data));
    }).getRecordsFin();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataNevistavleno', JSON.stringify(data));
    }).startDataNevistvleno();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataNeoplacheno', JSON.stringify(data));
    }).startDataNeoplacheno();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataSotr2', JSON.stringify(data));
    }).testSotrCount();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataInspektor', JSON.stringify(data));
    }).inspektorGs();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataVraboteR', JSON.stringify(data));
    }).startDataVraboteR();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataVraboteT', JSON.stringify(data));
    }).startDataVraboteT();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataArrival', JSON.stringify(data));
      startArrivalWaste();
    }).getLastTenRowsArriwal();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataWaste', JSON.stringify(data));
      startArrivalWaste();
    }).getLastTenRowsWaste();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataCashe', JSON.stringify(data));
    }).getDropDownArrayCashe();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataWaste', JSON.stringify(data));
    }).getLastTenRowsWaste();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('dataArrival', JSON.stringify(data));
    }).getLastTenRowsArriwal();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('stopAw', JSON.stringify(data));
    }).stopArrivalWaste();
     google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('casheRom1', (data));
    }).getRecordsCashe1();
    google.script.run.withSuccessHandler((data) => {
      localStorage.setItem('casheRom2', (data));
    }).getRecordsCashe2();
  }
 // onlineDownloads();


</script>